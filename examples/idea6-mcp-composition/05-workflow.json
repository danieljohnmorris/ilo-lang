{
  "meta": {
    "tools": ["mcp://warehouse/reserve", "mcp://warehouse/release", "mcp://payments/charge", "mcp://orders/make-id"],
    "input": {"payment-id": "text", "amount": "number", "items": "list item"},
    "output": "result receipt text"
  },
  "steps": [
    {"let": "rid", "call": "mcp://warehouse/reserve", "with": {"items": "$.items"},
     "err": "Inventory unavailable: ${err}"},
    {"let": "cid", "call": "mcp://payments/charge", "with": {"payment-id": "$.payment-id", "amount": "$.amount"},
     "err": "Payment failed: ${err}",
     "compensate": [{"call": "mcp://warehouse/release", "with": {"reservation-id": "$rid"}}]},
    {"let": "oid", "call": "mcp://orders/make-id"},
    {"ok": {"order-id": "$oid", "charge-id": "$cid", "reservation-id": "$rid"}}
  ]
}
