; fn process(order:order) -> result order text
; Registry: Tools: 0=validate 1=shipping 2=discount
; Vars: 0=order(input) 1=valid 2=ship 3=disc 4=final
; Fields: 0=addr 1=weight 2=country 3=subtotal 4=code 5=total 6=cost

LET 1 CALL 0 1 0 FIELD 0 0
IF NOT REF 1 1
  RET_ERR LIT 0 "Invalid shipping address"
LET 2 CALL 1 2 1 FIELD 0 1 2 FIELD FIELD 0 0 2
LET 3 CALL 2 2 3 FIELD 0 3 4 FIELD 0 4
LET 4 ADD SUB FIELD 0 3 REF 3 REF 2
RET_OK MERGE REF 0 5 REF 4 6 REF 2
