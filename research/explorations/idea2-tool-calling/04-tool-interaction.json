{
  "function": "notify",
  "input": {"user-id": "text", "message": "text"},
  "output": "result nil text",
  "steps": [
    {
      "let": "user",
      "call": "get-user",
      "args": {"user-id": "$input.user-id"},
      "on-error": {"return": {"error": "User lookup failed: $error"}}
    },
    {
      "if": {"not": "$user.verified"},
      "return": {"error": "Email not verified"}
    },
    {
      "call": "send-email",
      "args": {
        "to": "$user.email",
        "subject": "Notification",
        "body": "$input.message"
      },
      "on-error": {"return": {"error": "Send failed: $error"}}
    },
    {"return": {"ok": null}}
  ]
}
