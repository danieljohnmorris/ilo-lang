{"fn":"process","in":{"order":"order"},"out":"result order text","deps":["validate","shipping","discount"],"body":[{"let":"valid","call":"validate","args":{"addr":"order.addr"}},{"if":{"not":"valid"},"ret":{"err":"Invalid shipping address"}},{"let":"ship","call":"shipping","args":{"weight":"order.weight","dest":"order.addr.country"}},{"let":"disc","call":"discount","args":{"subtotal":"order.subtotal","code":"order.code"}},{"let":"final","op":"+","a":{"op":"-","a":"order.subtotal","b":"disc"},"b":"ship"},{"ret":{"ok":{"merge":"order","set":{"total":"final","cost":"ship"}}}}]}
